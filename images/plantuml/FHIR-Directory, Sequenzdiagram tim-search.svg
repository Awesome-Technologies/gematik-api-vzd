<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1252.0833px" preserveAspectRatio="none" style="width:1520px;height:1252px;background:#FFFFFF;" version="1.1" viewBox="0 0 1520 1252" width="1520.8333px" zoomAndPan="magnify"><defs><filter height="300%" id="f1n181j5olnnxw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0833333333333335"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.166666666666667" dy="4.166666666666667" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="1043.9372" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="185.4167" y="102.3926"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="503.5319" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="552.0833" y="642.7979"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="273.3968" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="850" y="315.9993"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="122.5667" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1265.625" y="786.0596"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="46.11" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1265.625" y="971.403"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="30.3467" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1413.5417" y="255.306"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="46.11" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1413.5417" y="421.7611"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="382.2835" style="stroke:#000000;stroke-width:2.0833333333333335;" width="1407.8125" x="98.4375" y="215.446"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="170.7601" style="stroke:#000000;stroke-width:2.0833333333333335;" width="842.1875" x="499.4792" y="746.1995"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="94.3034" style="stroke:#000000;stroke-width:2.0833333333333335;" width="842.1875" x="499.4792" y="931.543"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="32.2917" x2="32.2917" y1="91.9759" y2="1165.0798"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="190.1042" x2="190.1042" y1="91.9759" y2="1165.0798"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="556.7708" x2="556.7708" y1="91.9759" y2="1165.0798"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="854.6875" x2="854.6875" y1="91.9759" y2="1165.0798"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="1270.8333" x2="1270.8333" y1="91.9759" y2="1165.0798"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:5.0,5.0;" x1="1418.75" x2="1418.75" y1="91.9759" y2="1165.0798"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="47.9167" x="5.2083" y="88.5366">Nutzer</text><ellipse cx="32.2917" cy="15.625" fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" rx="8.3333" ry="8.3333" style="stroke:#383838;stroke-width:2.0833333333333335;"/><path d="M32.2917,23.9583 L32.2917,52.0833 M18.75,32.2917 L45.8333,32.2917 M32.2917,52.0833 L18.75,67.7083 M32.2917,52.0833 L45.8333,67.7083 " fill="none" filter="url(#f1n181j5olnnxw)" style="stroke:#383838;stroke-width:2.0833333333333335;"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="47.9167" x="5.2083" y="1177.5747">Nutzer</text><ellipse cx="32.2917" cy="1191.4307" fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" rx="8.3333" ry="8.3333" style="stroke:#383838;stroke-width:2.0833333333333335;"/><path d="M32.2917,1199.764 L32.2917,1227.889 M18.75,1208.0973 L45.8333,1208.0973 M32.2917,1227.889 L18.75,1243.514 M32.2917,1227.889 L45.8333,1243.514 " fill="none" filter="url(#f1n181j5olnnxw)" style="stroke:#383838;stroke-width:2.0833333333333335;"/><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="159.375" x="108.8542" y="55.2083"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="144.7917" x="116.1458" y="76.0366">TI-Messenger-Client</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="159.375" x="108.8542" y="1164.0381"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="144.7917" x="116.1458" y="1184.8663">TI-Messenger-Client</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="90.625" x="509.8958" y="55.2083"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="76.0417" x="517.1875" y="76.0366">FHIR-Proxy</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="90.625" x="509.8958" y="1164.0381"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="76.0417" x="517.1875" y="1184.8663">FHIR-Proxy</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="105.2083" x="800.5208" y="55.2083"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="90.625" x="807.8125" y="76.0366">Auth-Service</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="105.2083" x="800.5208" y="1164.0381"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="90.625" x="807.8125" y="1184.8663">Auth-Service</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="116.6667" x="1210.4167" y="55.2083"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="102.0833" x="1217.7083" y="76.0366">FHIR-Directory</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="31.5592" style="stroke:#383838;stroke-width:1.5625;" width="116.6667" x="1210.4167" y="1164.0381"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="102.0833" x="1217.7083" y="1184.8663">FHIR-Directory</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="48.5352" style="stroke:#383838;stroke-width:1.5625;" width="150" x="1341.6667" y="38.2324"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="134.375" x="1349.4792" y="59.0607">Matrix-Homeserver</text><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="135.4167" x="1348.9583" y="76.0366">(Messenger-Proxy)</text><rect fill="#F8F8F8" filter="url(#f1n181j5olnnxw)" height="48.5352" style="stroke:#383838;stroke-width:1.5625;" width="150" x="1341.6667" y="1164.0381"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="134.375" x="1349.4792" y="1184.8663">Matrix-Homeserver</text><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="135.4167" x="1348.9583" y="1201.8422">(Messenger-Proxy)</text><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="1043.9372" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="185.4167" y="102.3926"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="503.5319" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="552.0833" y="642.7979"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="273.3968" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="850" y="315.9993"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="122.5667" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1265.625" y="786.0596"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="46.11" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1265.625" y="971.403"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="30.3467" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1413.5417" y="255.306"/><rect fill="#FFFFFF" filter="url(#f1n181j5olnnxw)" height="46.11" style="stroke:#383838;stroke-width:1.0416666666666667;" width="10.4167" x="1413.5417" y="421.7611"/><polygon fill="#383838" points="172.9167,136.0026,183.3333,140.1693,172.9167,144.3359,177.0833,140.1693" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="32.2917" x2="179.1667" y1="140.1693" y2="140.1693"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="63.5417" x="39.5833" y="119.1289">gibt FHIR-</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="128.125" x="39.5833" y="134.8923">Suchparameter ein</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="195.8333" x2="239.5833" y1="186.2793" y2="186.2793"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="239.5833" x2="239.5833" y1="186.2793" y2="199.821"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="196.875" x2="239.5833" y1="199.821" y2="199.821"/><polygon fill="#383838" points="207.2917,195.6543,196.875,199.821,207.2917,203.9876,203.125,199.821" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="341.6667" x="203.125" y="165.239">prÃ¼fe ob noch gÃ¼ltiges tim-search-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="157.2917" x="203.125" y="181.0023">vom FHIR-Proxy vorliegt</text><path d="M98.4375,215.446 L165.1042,215.446 L165.1042,222.7376 L154.6875,233.1543 L98.4375,233.1543 L98.4375,215.446 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0416666666666667;"/><rect fill="none" height="382.2835" style="stroke:#000000;stroke-width:2.0833333333333335;" width="1407.8125" x="98.4375" y="215.446"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="114.0625" y="229.0573">alt</text><text fill="#000000" font-family="sans-serif" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="346.875" x="180.7292" y="228.1652">[kein gÃ¼ltiges tim-search-accesstoken vorhanden]</text><polygon fill="#383838" points="1401.0417,251.1393,1411.4583,255.306,1401.0417,259.4727,1405.2083,255.306" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="195.8333" x2="1407.2917" y1="255.306" y2="255.306"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="394.7917" x="203.125" y="250.029">POST /_matrix/client/r0/user/{userId}/openid/request_token</text><polygon fill="#383838" points="207.2917,281.486,196.875,285.6527,207.2917,289.8193,203.125,285.6527" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="201.0417" x2="1417.7083" y1="285.6527" y2="285.6527"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="750" x="213.5417" y="280.3757">HTTP 200 OK, Result body {"access_token": "Matrix-OpenID-Token",..., "matrix_server_name": "example.com",...}</text><polygon fill="#383838" points="837.5,311.8327,847.9167,315.9993,837.5,320.166,841.6667,315.9993" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="195.8333" x2="843.75" y1="315.9993" y2="315.9993"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="427.0833" x="203.125" y="310.7224">GET /tim-authenticate... (Auth Header mit Matrix-OpenID-Token)</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="860.4167" x2="904.1667" y1="362.1094" y2="362.1094"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="904.1667" x2="904.1667" y1="362.1094" y2="375.651"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="861.4583" x2="904.1667" y1="375.651" y2="375.651"/><polygon fill="#383838" points="871.875,371.4844,861.4583,375.651,871.875,379.8177,867.7083,375.651" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="211.4583" x="867.7083" y="341.069">PrÃ¼fe ob matrix_server_name</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="197.9167" x="867.7083" y="356.8324">in FÃ¶derationsliste enthalten</text><polygon fill="#383838" points="1401.0417,417.5944,1411.4583,421.7611,1401.0417,425.9277,1405.2083,421.7611" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="860.4167" x2="1407.2917" y1="421.7611" y2="421.7611"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="147.9167" x="867.7083" y="400.7207">GET /openid/userinfo/?</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="246.875" x="867.7083" y="416.4841">access_token=Matrix-OpenID-Token)</text><polygon fill="#383838" points="871.875,463.7044,861.4583,467.8711,871.875,472.0378,867.7083,467.8711" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="865.625" x2="1417.7083" y1="467.8711" y2="467.8711"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="85.4167" x="878.125" y="446.8307">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="210.4167" x="878.125" y="462.5941">(Result Body MXID des Nutzers)</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="860.4167" x2="904.1667" y1="498.2178" y2="498.2178"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="904.1667" x2="904.1667" y1="498.2178" y2="511.7594"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="861.4583" x2="904.1667" y1="511.7594" y2="511.7594"/><polygon fill="#383838" points="871.875,507.5928,861.4583,511.7594,871.875,515.9261,867.7083,511.7594" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="390.625" x="867.7083" y="492.9408">erzeuge tim-search-accesstoken fÃ¼r TI-Messenger-Client</text><polygon fill="#383838" points="207.2917,585.2295,196.875,589.3962,207.2917,593.5628,203.125,589.3962" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="201.0417" x2="854.1667" y1="589.3962" y2="589.3962"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="170.8333" x="213.5417" y="536.8291">HTTP 200 OK, Result body</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="218.75" x="213.5417" y="552.5925">{"access_token"="accesstoken",</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="146.875" x="213.5417" y="568.3558">"token_type":"bearer",</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="131.25" x="213.5417" y="584.1192">"expires_in":86400}</text><polygon fill="#383838" points="539.5833,638.6312,550,642.7979,539.5833,646.9645,543.75,642.7979" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="195.8333" x2="545.8333" y1="642.7979" y2="642.7979"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="245.8333" x="203.125" y="621.7575">GET /tim-search?... (Auth Header mit</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="165.625" x="203.125" y="637.5209">tim-search-accesstoken)</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="606.25" y1="673.1445" y2="673.1445"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="606.25" x2="606.25" y1="673.1445" y2="686.6862"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="563.5417" x2="606.25" y1="686.6862" y2="686.6862"/><polygon fill="#383838" points="573.9583,682.5195,563.5417,686.6862,573.9583,690.8529,569.7917,686.6862" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="213.5417" x="569.7917" y="667.8675">prÃ¼fe tim-search-accesstoken</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="606.25" y1="717.0329" y2="717.0329"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="606.25" x2="606.25" y1="717.0329" y2="730.5745"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="563.5417" x2="606.25" y1="730.5745" y2="730.5745"/><polygon fill="#383838" points="573.9583,726.4079,563.5417,730.5745,573.9583,734.7412,569.7917,730.5745" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="272.9167" x="569.7917" y="711.7559">werden TIPractitioner-EintrÃ¤ge gesucht?</text><path d="M499.4792,746.1995 L566.1458,746.1995 L566.1458,753.4912 L555.7292,763.9079 L499.4792,763.9079 L499.4792,746.1995 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0416666666666667;"/><rect fill="none" height="170.7601" style="stroke:#000000;stroke-width:2.0833333333333335;" width="842.1875" x="499.4792" y="746.1995"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="515.1042" y="759.8109">alt</text><text fill="#000000" font-family="sans-serif" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="310.4167" x="581.7708" y="758.9188">[TIPractitionerRole-EintrÃ¤ge werden gesucht]</text><polygon fill="#383838" points="1253.125,781.8929,1263.5417,786.0596,1253.125,790.2262,1257.2917,786.0596" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="1259.375" y1="786.0596" y2="786.0596"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="159.375" x="569.7917" y="780.7826">GET /?...&lt;eigene MXID&gt;</text><polygon fill="#383838" points="573.9583,828.0029,563.5417,832.1696,573.9583,836.3363,569.7917,832.1696" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="567.7083" x2="1264.5833" y1="832.1696" y2="832.1696"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="85.4167" x="580.2083" y="811.1293">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="288.5417" x="580.2083" y="826.8926">(Result Body json mit TIPractitioner-Eintrag)</text><polygon fill="#383838" points="1253.125,858.3496,1263.5417,862.5163,1253.125,866.6829,1257.2917,862.5163" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="1259.375" y1="862.5163" y2="862.5163"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="54.1667" x="569.7917" y="857.2393">GET /?...</text><polygon fill="#383838" points="573.9583,904.4596,563.5417,908.6263,573.9583,912.793,569.7917,908.6263" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="567.7083" x2="1269.7917" y1="908.6263" y2="908.6263"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="85.4167" x="580.2083" y="887.586">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="119.7917" x="580.2083" y="903.3493">(Result Body json)</text><path d="M499.4792,931.543 L566.1458,931.543 L566.1458,938.8346 L555.7292,949.2513 L499.4792,949.2513 L499.4792,931.543 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0416666666666667;"/><rect fill="none" height="94.3034" style="stroke:#000000;stroke-width:2.0833333333333335;" width="842.1875" x="499.4792" y="931.543"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="515.1042" y="945.1543">alt</text><text fill="#000000" font-family="sans-serif" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="325" x="581.7708" y="944.2622">[TIHealthcareService-EintrÃ¤ge werden gesucht]</text><polygon fill="#383838" points="1253.125,967.2363,1263.5417,971.403,1253.125,975.5697,1257.2917,971.403" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="1259.375" y1="971.403" y2="971.403"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="54.1667" x="569.7917" y="966.126">GET /?...</text><polygon fill="#383838" points="573.9583,1013.3464,563.5417,1017.513,573.9583,1021.6797,569.7917,1017.513" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="567.7083" x2="1269.7917" y1="1017.513" y2="1017.513"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="85.4167" x="580.2083" y="996.4727">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="119.7917" x="580.2083" y="1012.236">(Result Body json)</text><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="562.5" x2="606.25" y1="1086.6781" y2="1086.6781"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="606.25" x2="606.25" y1="1086.6781" y2="1100.2197"/><line style="stroke:#383838;stroke-width:1.0416666666666667;" x1="563.5417" x2="606.25" y1="1100.2197" y2="1100.2197"/><polygon fill="#383838" points="573.9583,1096.0531,563.5417,1100.2197,573.9583,1104.3864,569.7917,1100.2197" style="stroke:#383838;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="107.2917" x="569.7917" y="1049.8744">prÃ¼fe telecom</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="63.5417" x="569.7917" y="1065.6377">Elemente</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="162.5" x="569.7917" y="1081.4011">und ergÃ¤nze PASSporT</text><polygon fill="#383838" points="202.0833,1142.1631,191.6667,1146.3298,202.0833,1150.4964,197.9167,1146.3298" style="stroke:#383838;stroke-width:1.0416666666666667;"/><line style="stroke:#383838;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="195.8333" x2="556.25" y1="1146.3298" y2="1146.3298"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="230.2083" x="208.3333" y="1125.2894">HTTP 200 OK (Result Body json mit</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="137.5" x="208.3333" y="1141.0528">MXID und PASSporT)</text><!--MD5=[8f40e8b04c3f282feedfc5f99e082a28]
@startuml
skinparam dpi 100
skinparam WrapWidth 200
skinparam monochrome true

'title "FHIR-Directory, Sequenzdiagram tim-search'
actor Nutzer
participant cl as "TI-Messenger-Client"
participant fp as "FHIR-Proxy"
participant au as "Auth-Service"
participant fd as "FHIR-Directory"
participant hs as "Matrix-Homeserver\n(Messenger-Proxy)"
activate cl
Nutzer -> cl:gibt FHIR-\nSuchparameter ein
cl -> cl: prÃ¼fe ob noch gÃ¼ltiges tim-search-accesstoken\nvom FHIR-Proxy vorliegt
alt kein gÃ¼ltiges tim-search-accesstoken vorhanden
cl -> hs: POST /_matrix/client/r0/user/{userId}/openid/request_token
activate hs
hs - -> cl: HTTP 200 OK, Result body {"access_token": "Matrix-OpenID-Token",..., "matrix_server_name": "example.com",...}
deactivate hs
cl -> au: GET /tim-authenticate... (Auth Header mit Matrix-OpenID-Token)
activate au
au -> au: PrÃ¼fe ob matrix_server_name\nin FÃ¶derationsliste enthalten
au -> hs: GET /openid/userinfo/?\naccess_token=Matrix-OpenID-Token)
activate hs
hs - -> au: HTTP 200 OK\n(Result Body MXID des Nutzers)
deactivate hs
au -> au: erzeuge tim-search-accesstoken fÃ¼r TI-Messenger-Client
au - -> cl: HTTP 200 OK, Result body\n{"access_token"="accesstoken",\n"token_type":"bearer",\n"expires_in":86400}
deactivate au
end
cl -> fp: GET /tim-search?... (Auth Header mit\ntim-search-accesstoken)
activate fp
fp -> fp: prÃ¼fe tim-search-accesstoken
fp -> fp: werden TIPractitioner-EintrÃ¤ge gesucht?
alt TIPractitionerRole-EintrÃ¤ge werden gesucht
fp -> fd: GET /?...<eigene MXID>
activate fd
fd - -> fp: HTTP 200 OK\n(Result Body json mit TIPractitioner-Eintrag)
fp -> fd: GET /?...
fd - -> fp: HTTP 200 OK\n(Result Body json)
deactivate fd
end
alt TIHealthcareService-EintrÃ¤ge werden gesucht
fp -> fd: GET /?...
activate fd
fd - -> fp: HTTP 200 OK\n(Result Body json)
deactivate fd
end
fp -> fp: prÃ¼fe telecom\nElemente\nund ergÃ¤nze PASSporT
fp - -> cl: HTTP 200 OK (Result Body json mit\nMXID und PASSporT)
deactivate fp
deactivate cl
@enduml

@startuml
skinparam dpi 100
skinparam WrapWidth 200
skinparam monochrome true

actor Nutzer
participant cl as "TI-Messenger-Client"
participant fp as "FHIR-Proxy"
participant au as "Auth-Service"
participant fd as "FHIR-Directory"
participant hs as "Matrix-Homeserver\n(Messenger-Proxy)"
activate cl
Nutzer -> cl:gibt FHIR-\nSuchparameter ein
cl -> cl: prÃ¼fe ob noch gÃ¼ltiges tim-search-accesstoken\nvom FHIR-Proxy vorliegt
alt kein gÃ¼ltiges tim-search-accesstoken vorhanden
cl -> hs: POST /_matrix/client/r0/user/{userId}/openid/request_token
activate hs
hs - -> cl: HTTP 200 OK, Result body {"access_token": "Matrix-OpenID-Token",..., "matrix_server_name": "example.com",...}
deactivate hs
cl -> au: GET /tim-authenticate... (Auth Header mit Matrix-OpenID-Token)
activate au
au -> au: PrÃ¼fe ob matrix_server_name\nin FÃ¶derationsliste enthalten
au -> hs: GET /openid/userinfo/?\naccess_token=Matrix-OpenID-Token)
activate hs
hs - -> au: HTTP 200 OK\n(Result Body MXID des Nutzers)
deactivate hs
au -> au: erzeuge tim-search-accesstoken fÃ¼r TI-Messenger-Client
au - -> cl: HTTP 200 OK, Result body\n{"access_token"="accesstoken",\n"token_type":"bearer",\n"expires_in":86400}
deactivate au
end
cl -> fp: GET /tim-search?... (Auth Header mit\ntim-search-accesstoken)
activate fp
fp -> fp: prÃ¼fe tim-search-accesstoken
fp -> fp: werden TIPractitioner-EintrÃ¤ge gesucht?
alt TIPractitionerRole-EintrÃ¤ge werden gesucht
fp -> fd: GET /?...<eigene MXID>
activate fd
fd - -> fp: HTTP 200 OK\n(Result Body json mit TIPractitioner-Eintrag)
fp -> fd: GET /?...
fd - -> fp: HTTP 200 OK\n(Result Body json)
deactivate fd
end
alt TIHealthcareService-EintrÃ¤ge werden gesucht
fp -> fd: GET /?...
activate fd
fd - -> fp: HTTP 200 OK\n(Result Body json)
deactivate fd
end
fp -> fp: prÃ¼fe telecom\nElemente\nund ergÃ¤nze PASSporT
fp - -> cl: HTTP 200 OK (Result Body json mit\nMXID und PASSporT)
deactivate fp
deactivate cl
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>